---
- name: Init {{_name}} build configuration
  command: autoreconf -i
  args:
    chdir: "{{source_path}}"
    removes: configure.ac
  tags: build, autoconf
- name: Configure {{_name}}
  command: ./configure {{configuration | default()}}
  args:
    chdir: "{{source_path}}"
    removes: configure
  tags: build, configure
- name: Clean {{_name}} artifacts
  command: make clean
  when: clean
  args:
    chdir: "{{source_path}}"
  tags: build
- name: Remove generated artifacts
  file: path="{{source_path}}/{{item}}" state=absent
  with_items:
    "{{generated_artifacts}}"
  tags: build
- name: Build {{_name}}
  command: make
  args:
    chdir: "{{source_path}}"
    removes: Makefile
  tags: build, make
- name: Install {{_name}}
  command: make install
  args:
    chdir: "{{source_path}}"
    removes: Makefile
  become: yes
  tags: install
